
mal_folder_name='mal_test';
malTestLogFiles=dir(fullfile(mal_folder_name,'*.txt'));
malTestLogFiles(1).contents = [];
malTest_numfiles = numel(malTestLogFiles);

benTest_folder_name='ben_test';
benTestLogFiles=dir(fullfile(benTest_folder_name,'*.txt'));
benTest_numfiles = length(benTestLogFiles);

delimiter = '(';
formatSpec = '%s%*s%[^\n\r]';
alpha = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
API_test = {};
for k = 1: malTest_numfiles
    fprintf('extracting test data from txt files :mal %d\n',k/malTest_numfiles);
    filename = strcat(mal_folder_name,'\',malTestLogFiles(k).name);
    fileID = fopen(filename,'r');
    dataArray = textscan(fileID, formatSpec, 'Delimiter', delimiter,  'ReturnOnError', false);
    dataArray = dataArray{1};
    dellist = [1];
    for i=2:numel(dataArray)
        temp = dataArray{i};
        if numel(temp) >10
            if sum(ismember(temp(1),alpha))==0 || (strcmp(temp(1:10),'Executing:'))
                dellist = [dellist i];
            end
        end
    end
    
    fclose(fileID);
    dataArray(dellist) = [];
    API_test = [API_test dataArray{:}];
    malTestLogFiles(k).contents = dataArray;
    
    clearvars filename fileID dataArray ans;
end

for k = 1: benTest_numfiles
    fprintf('extracting test data from txt files :ben %d\n',k/benTest_numfiles);
    filename = strcat(benTest_folder_name ,'\', benTestLogFiles(k).name);
    fileID = fopen(filename,'r');
    dataArray = textscan(fileID, formatSpec, 'Delimiter', delimiter,  'ReturnOnError', false);
    dataArray = dataArray{1};
    dellist = [1];
    for i=2:numel(dataArray)
        temp = dataArray{i};
        if numel(temp) >10
            if ~isstrprop(temp(1),'alpha') || (strcmp(temp(1:10),'Executing:'))
                dellist = [dellist i];
                
            end
        end
    end
    
    fclose(fileID);
    dataArray(dellist) = [];
    API_test = [API_test dataArray{:}];
    benTestLogFiles(k).contents = dataArray;
    
    clearvars filename fileID dataArray ans;
end


api_test_unique = setdiff(unique(API_test),api);
api = [api api_test_unique];
 
for k = 1:numel(malTestLogFiles)
    fprintf('converting to api_test id : mal %d\n',k/malTest_numfiles);
    
    dataArray = (malTestLogFiles(k).contents);
    for i=1:numel(dataArray)
        for j=1:numel(api)
            if strcmp(api{j}, dataArray{i})
                
                dataArray{i} = j;
            end
        end
    end
    dataArray = cell2mat(dataArray);
    
    malTestLogFiles(k).contents = dataArray;
end

for k = 1:numel(benTestLogFiles)
    fprintf('converting to api_test id : ben %d\n',k/benTest_numfiles);
    
    dataArray = (benTestLogFiles(k).contents);
    for i=1:numel(dataArray)
        for j=1:numel(api)
            if strcmp(api{j}, dataArray{i})
                
                dataArray{i} = j;
            end
        end
    end
    dataArray = cell2mat(dataArray);
    benTestLogFiles(k).contents = dataArray;
end

clearvars temp mal_folder_name i j k formatSpec dellist dataArray benTest_folder_name delimiter;